<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>~/site — console</title>
  <style>
    :root{
  --asciiOpacity: 0.18; /* прозрачность ASCII-фона */
  --asciiSize: 8px;     /* размер символов */
}
#asciiLayer{
  position:fixed; inset:0; z-index:0; pointer-events:none;
  color:var(--ink); opacity:var(--asciiOpacity);
  font: normal var(--asciiSize)/1 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space:pre; letter-spacing:0; overflow:hidden; user-select:none;
}
@keyframes redPulse {
  0%   { color:#ff3030; }
  25%  { color:#ff5050; }
  50%  { color:#ff8080; }
  75%  { color:#ff5050; }
  100% { color:#ff3030; }
}
#asciiProgress {
  position:fixed; left:0; right:0; bottom:0; z-index:3;
  text-align:center;
  font:normal 12px/1 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  padding:6px 8px; white-space:pre;
  opacity:.95;
  animation:redPulse 1.8s infinite ease-in-out;  /* добавили перелив */
}

video, canvas{ display:none; }             /* источники прячем */
.wrap{ position:relative; z-index:1; }     /* чтобы консоль была поверх ASCII */
    :root{
      /* You can tweak these if needed */
      --bg:#000;           /* terminal background */
      --ink:#c7c7c7;       /* terminal foreground (set to #00ff00 for green) */
      --muted:#8a8a8a;     /* dim text */
      --accent:#c7c7c7;    /* prompt symbol color */
      --caret:currentColor;/* caret inherits current text color */
      --maxw: 1000px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font: 15px/1.5 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    }
    .wrap{min-height:100%; display:flex;}
    main{
      width:100%; margin:auto; max-width:var(--maxw);
      padding:24px 12px 48px; /* bottom padding for mobile keyboards */
    }
    .title{color:var(--ink);}
    .dim{color:var(--muted)}
    .block{margin: 16px 0}
    .prompt{display:flex; gap:.5rem; align-items:flex-start;}
    .ps1{white-space:nowrap}
    .line{flex:1; min-width:0}
    .input{display:inline-block; min-height:1em; outline:0; white-space:pre-wrap; word-break:break-word}
    .cursor{display:inline-block; width:9px; height:1em; margin-left:2px; background:var(--caret); animation:blink 1.2s steps(1) infinite}
    @keyframes blink{50%{opacity:0}}

    /* Output */
    .out{white-space:pre-wrap}

    /* Minimal scrollbar styling (neutral) */
    ::-webkit-scrollbar{width:8px; height:8px}
    ::-webkit-scrollbar-thumb{background:#2a2a2a}
    ::selection{background:#444; color:#fff}

    /* Links (keep neutral) */
    a{color:inherit; text-decoration:underline}
    a:hover{text-decoration:none}

    /* Mobile tweaks */
    @media (max-width:640px){
      main{padding:16px 10px 40px}
    }
  </style>
</head>
<body>
    <!-- ASCII video backdrop -->
<pre id="asciiLayer" aria-hidden="true"></pre>
<video id="srcVideo" loop muted playsinline crossorigin="anonymous"></video>
<canvas id="workCanvas"></canvas>
<input id="fileInput" type="file" accept="video/*" style="display:none" />

  <div class="wrap">
  <pre id="asciiProgress" aria-hidden="true"></pre>

    <main aria-label="Console">
      <div class="block">
        <div class="title">Console mode</div>
        <div class="dim">Type <code>help</code> to list commands. No animations. No gradients. Just text.</div>
      </div>

      <div id="terminal" role="region" aria-live="polite"></div>

      <div class="prompt" aria-label="Command line">
        <div class="ps1"><span class="dim">guest</span>@site:<span class="dim">~</span>$</div>
        <div class="line">
          <span id="input" class="input" contenteditable spellcheck="false" aria-label="Command input"></span><span class="cursor" aria-hidden="true"></span>
        </div>
      </div>
    </main>
  </div>

  <script>
  (function(){
    const term = document.getElementById('terminal');
    const input = document.getElementById('input');
    const PS1 = '<span class="dim">guest</span>@site:<span class="dim">~</span>$';

    const commands = {
      help(){
        return [
          'Available commands:',
          '  help        Show this help',
          '  about       about project',
          '  contact     How to reach us',
          '  tasks       Our tasks and progress',
          '  theme mono  Force monochrome (default)',
          '  theme green Classic green phosphor',
          '  clear       Clear the screen'
        ].join('\n');
      },
      about(){
        return [
          '# about',
          '1. EyeAI is an engineering cheat tool.',
          '2. It is a small microchip with a camera.',
          '3. It combines computer vision with LLM\'s which optimize engineer\'s workflow.',
          '4. We use RAG 3>. You can fine-tune the model on your own documentary or images for implementing in various fields'
        ].join('\n');
      },
      tasks(){
        return [
          '# tasks',
          '- making a site              [done]',
          '- buying microchips          [done]',
          '- basic camera logic         [done]',
          '- button for sending photos  [done]',
          '- server deploy              [in progress]',
          '- building rag               [in progress]',
          '- testing                    [undone]',
          '- making a comfortable case  [undone]'
        ].join('\n');
      },
      contact(){
        return [
          '# contact',
          'sanya    aka @Doushe1',
          'kirill   aka @barinvq'
        ].join('\n');
      },
      theme(args){
        const mode = (args[0]||'').toLowerCase();
        if(mode === 'green'){
          document.documentElement.style.setProperty('--ink','#00ff00');
          document.documentElement.style.setProperty('--muted','#1bb91b');
          return 'Theme set: green';
        }
        if(mode === 'mono' || mode === ''){
          document.documentElement.style.setProperty('--ink','#c7c7c7');
          document.documentElement.style.setProperty('--muted','#8a8a8a');
          return 'Theme set: mono';
        }
        return 'Unknown theme. Try: theme mono | theme green';
      },
      clear(){ term.innerHTML=''; return '' }
    };

    const history = [];
    let index = -1;

    function print(cmd, out){
      const block = document.createElement('div');
      block.className = 'block';
      block.innerHTML = `<div class="prompt"><div class="ps1">${PS1}</div><div class="line">${escapeHtml(cmd)}</div></div>` + (out? `<div class="out">${escapeHtml(out)}</div>`: '');
      term.appendChild(block);
      window.scrollTo(0, document.body.scrollHeight);
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]));
    }

    function run(raw){
      const line = raw.trim();
      if(!line){ print('', ''); return; }
      const [name, ...args] = line.split(/\s+/);
      if(commands[name]){
        const res = commands[name](args);
        print(line, res);
      } else {
        print(line, `${name}: command not found (try 'help')`);
      }
    }

    // Key handling
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){
        e.preventDefault();
        const value = input.textContent;
        history.unshift(value);
        index = -1;
        input.textContent = '';
        run(value);
        return;
      }
      if(e.key === 'ArrowUp'){
        e.preventDefault();
        if(history.length){
          index = Math.min(index+1, history.length-1);
          input.textContent = history[index];
          placeCaretAtEnd(input);
        }
        return;
      }
      if(e.key === 'ArrowDown'){
        e.preventDefault();
        if(history.length){
          index = Math.max(index-1, -1);
          input.textContent = index === -1 ? '' : history[index];
          placeCaretAtEnd(input);
        }
        return;
      }
    });

    // Focus input on click anywhere
    document.addEventListener('click', ()=> input.focus());
    input.focus();

    function placeCaretAtEnd(el){
      const range = document.createRange();
      range.selectNodeContents(el);
      range.collapse(false);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    }

    // Initial greeting (kept minimal)
    print('','Type \u201chelp\u201d for commands.');
  })();
  </script>

<script>
(function(){
  const asciiLayer = document.getElementById('asciiLayer');
  const video = document.getElementById('srcVideo');
  const work = document.getElementById('workCanvas');
  const wctx = work.getContext('2d', { willReadFrequently: true });
  const fileInput = document.getElementById('fileInput');

  let asciiEnabled = false, rafId = null;
  let density = 'med';           // low | med | high
  let cols = 180;                // авто-подстроим ниже
  const CHARSETS = {
    light: " .'`^\",:;~-_+*i!lI?><][}{1)(|\\/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$",
    solid: " .:-=+*#%@"
  };
  let charset = CHARSETS.light;

  function setColsForViewport(){
    const size = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--asciiSize')) || 8;
    const vw = window.innerWidth, estCharW = size * 0.6;
    const target = Math.max(60, Math.floor(vw / estCharW));
    cols = density==='high' ? Math.floor(target*1.25) : density==='low' ? Math.floor(target*0.75) : target;
  }
  setColsForViewport(); window.addEventListener('resize', setColsForViewport);

  function frame(){
    if(!asciiEnabled || video.readyState < 2){ rafId = requestAnimationFrame(frame); return; }
    const charAspect = 2; // у моноширинных символов высота ≈2× ширины
    const rows = Math.max(30, Math.floor((cols * video.videoHeight / video.videoWidth) / charAspect));
    work.width = cols; work.height = rows;
    wctx.drawImage(video, 0, 0, cols, rows);
    const data = wctx.getImageData(0,0,cols,rows).data;
    const N = charset.length - 1;
    let out = '';
    for(let y=0; y<rows; y++){
      for(let x=0; x<cols; x++){
        const i = (y*cols + x)*4;
        const r=data[i], g=data[i+1], b=data[i+2];
        const lum = (0.299*r + 0.587*g + 0.114*b)/255; // 0..1
        out += charset[Math.round((1 - lum)*N)] || ' ';
      }
      out += '\n';
    }
    asciiLayer.textContent = out;
    rafId = requestAnimationFrame(frame);
  }

  function startAscii(){ if(!asciiEnabled){ asciiEnabled = true; cancelAnimationFrame(rafId); rafId = requestAnimationFrame(frame);} }
  function stopAscii(){ asciiEnabled = false; cancelAnimationFrame(rafId); }

  // === Мини-API для управления с «терминала», если он у тебя уже есть:
  window.ASCII = {
    on(){ startAscii(); return 'ASCII: on'; },
    off(){ stopAscii(); return 'ASCII: off'; },
    opacity(v){ document.documentElement.style.setProperty('--asciiOpacity', String(v)); return 'opacity: '+v; },
    size(px){ document.documentElement.style.setProperty('--asciiSize', px+'px'); setColsForViewport(); return 'size: '+px; },
    density(d){ density=d; setColsForViewport(); return 'density: '+d; },
    charset(name){ charset = CHARSETS[name] || charset; return 'charset: '+name; },
    url(link){ stopAscii(); video.src = link; video.currentTime = 0; video.play().then(startAscii); return 'loading URL'; },
    file(){ fileInput.click(); return 'choose file…'; },
    async webcam(on=true){
      if(on){
        try{
          const s = await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}, audio:false});
          video.srcObject = s; await video.play(); startAscii(); return 'webcam: on';
        }catch{ return 'webcam: denied/unavailable'; }
      } else {
        if(video.srcObject){ video.srcObject.getTracks().forEach(t=>t.stop()); video.srcObject=null; }
        stopAscii(); return 'webcam: off';
      }
    }
  };
  fileInput.addEventListener('change', ()=>{
    const f = fileInput.files?.[0]; if(!f) return;
    const url = URL.createObjectURL(f); ASCII.url(url);
  });

  // Пример автозапуска из файла/урла:
  // ASCII.url('your-video.mp4'); ASCII.on();
})();
</script>
<script>
(function(){
  const el = document.getElementById('asciiProgress');

  function makeBar(percent, cols){
    const width = Math.max(20, cols || Math.floor(window.innerWidth / 12));
    const p = Math.max(0, Math.min(1, percent));
    const filled = Math.round(p * width);
    const empty  = Math.max(0, width - filled);
    return `[${'#'.repeat(filled)}${'-'.repeat(empty)}] ${Math.round(p*100)}%`;
  }

  function update(){
    const doc = document.documentElement;
    const max = Math.max(1, doc.scrollHeight - window.innerHeight);
    const pct = window.scrollY / max;
    el.textContent = makeBar(0.5);
  }

  // обновляем по скроллу/resize и при загрузке
  window.addEventListener('scroll', update, {passive:true});
  window.addEventListener('resize', update);
  update();

  // маленький API для консоли (необязательно)
  window.ASCII = window.ASCII || {};
  window.ASCII.progress = function(show=true){
    el.style.display = show ? '' : 'none';
    update();
    return 'progress: ' + (show ? 'on' : 'off');
  };
})();
</script>



</body>
</html>
